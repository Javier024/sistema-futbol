<!DOCTYPE html>
<html lang="es">
<head><meta charset="UTF-8"><title>Gastos</title><link rel="stylesheet" href="../assets/css/styles.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"></head>
<body><div id="app-layout"><div id="sidebar-placeholder"></div><main><header><h1>Gastos</h1></header><div id="view-container" style="height:100%;"></div></main></div><div id="toast-container"></div>
<script src="../assets/js/common.js"></script><script>
window.addEventListener('DOMContentLoaded', () => { if(!checkAuth()) return; renderSidebar('gastos'); loadGastos(); });
function loadGastos() {
    const rows = db.getAll('gastos').sort((a,b)=>new Date(b.fecha_gasto)-new Date(a.fecha_gasto)).map(e => `<tr><td>${utils.formatDate(e.fecha_gasto)}</td><td>${e.concepto}</td><td style="color:var(--danger);font-weight:bold;">-${utils.formatMoney(e.monto)}</td><td><button class="btn btn-sm btn-danger" onclick="db.delete('gastos',${e.id});loadGastos();"><i class="fas fa-trash"></i></button></td></tr>`).join('');
    document.getElementById('view-container').innerHTML = `<div class="grid-2"><div class="card"><h3>Registrar</h3><form onsubmit="saveExp(event)"><div class="form-group"><label>Concepto</label><input id="c" required></div><div class="form-group"><label>Monto</label><input type="number" id="m" required></div><div class="form-group"><label>Fecha</label><input type="date" id="f" required></div><button class="btn btn-danger btn-block">Guardar</button></form></div><div class="card"><h3>Historial</h3><table><thead><tr><th>Fecha</th><th>Concepto</th><th>Monto</th><th></th></tr></thead><tbody>${rows||'<tr><td colspan="4">Sin gastos</td></tr>'}</tbody></table></div></div>`;
    document.getElementById('f').valueAsDate = new Date();
}
const saveExp = (e) => { e.preventDefault(); db.add('gastos', {concepto:document.getElementById('c').value, monto:document.getElementById('m').value, fecha_gasto:document.getElementById('f').value}); showToast('Guardado'); loadGastos(); };
</script></body></html>